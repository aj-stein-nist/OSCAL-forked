<?xml version="1.0" encoding="UTF-8"?>
<METASCHEMA xmlns="http://csrc.nist.gov/ns/oscal/metaschema/1.0" abstract="yes">
    <schema-name>OSCAL Rules -- Common Modules</schema-name>
    <schema-version>1.2.0</schema-version>
    <short-name>oscal-rules-common</short-name>
    <namespace>http://csrc.nist.gov/ns/oscal/1.0</namespace>
    <json-base-uri>http://csrc.nist.gov/ns/oscal</json-base-uri>
    <remarks>
        <p>TODO</p>
    </remarks>
    <import href="oscal_metadata_metaschema.xml"/>
    <define-assembly name="rule-definition">
        <formal-name>Rule Definition</formal-name>
        <description>TODO</description>
        <define-flag name="uuid" required="yes" as-type="uuid">
            <formal-name>Rule Definition Universally Unique Identifier</formal-name>
            <description>TODO</description>
        </define-flag>
    </define-assembly>
    <define-assembly name="test-definition">
        <formal-name>Test Definition</formal-name>
        <description>TODO</description>
        <define-flag name="uuid" required="yes" as-type="uuid">
            <formal-name>Test Definition Universally Unique Identifier</formal-name>
            <description>TODO</description>
        </define-flag>
    </define-assembly>
    <define-assembly name="testing-scenario">
        <formal-name>Rule Testing Scenario</formal-name>
        <description>A rule testing scenario</description>
        <use-name>scenario</use-name>
        <define-flag name="uuid" required="yes" as-type="uuid">
            <formal-name>Testing Scenario Universally Unique Identifier</formal-name>
            <description>TODO</description>
        </define-flag>
        <model>
            <assembly ref="rule-condition" min-occurs="1">
                <use-name>condition</use-name>
            </assembly>
        </model>
    </define-assembly>
    <define-assembly name="rule-condition">
        <formal-name>Rule Condition</formal-name>
        <description>A rule implementation condition</description>
        <define-flag name="operator" required="yes" as-type="token">
            <formal-name>Rule Condition Operator</formal-name>
            <description>TODO</description>
            <constraint>
                <allowed-values allow-other="no">
                    <enum value="and">and</enum>
                    <enum value="or">or</enum>
                    <enum value="not">not</enum>
                </allowed-values>
            </constraint>
        </define-flag>
        <model>
            <assembly ref="rule-condition">
                <use-name>pre-condition</use-name>
            </assembly>
            <choice>
                <assembly ref="rule-condition">
                    <use-name>condition</use-name>
                </assembly>
                <define-assembly name="test-reference" min-occurs="1" max-occurs="unbounded">
                    <formal-name>Test Reference</formal-name>
                    <description>TODO</description>
                    <define-flag name="uuid" required="yes" as-type="uuid">
                        <formal-name>Test Reference Universally Unique Identifier</formal-name>
                        <description>TODO</description>
                    </define-flag>
                    <define-flag name="test-uuid" required="yes" as-type="uuid">
                        <formal-name>Test Universally Unique Identifier Reference</formal-name>
                        <description>A test UUID reference</description>
                    </define-flag>
                </define-assembly>
            </choice>
        </model>
    </define-assembly>
    <define-assembly name="rule-implementation">
        <formal-name>Rule Implementation</formal-name>
        <description>TODO</description>
        <define-flag name="uuid" required="yes" as-type="uuid">
            <formal-name>Rule Implementation Universally Unique Identifier</formal-name>
            <description>TODO</description>
        </define-flag>
        <model>
            <define-assembly name="testing-scenario-reference">
                <formal-name>Testing Scenario Reference</formal-name>
                <description>A reference to a testing scenario.</description>
                <define-flag name="uuid" required="yes" as-type="uuid">
                    <formal-name>Rule Reference Universally Unique Identifier</formal-name>
                    <description>TODO</description>
                </define-flag>
                <define-flag name="rule-uuid" required="yes" as-type="uuid">
                    <formal-name>Rule Universally Unique Identifier Reference</formal-name>
                    <description>A rule UUID reference</description>
                </define-flag>
                <define-flag name="test-scenario-uuid" required="yes" as-type="uuid">
                    <formal-name>Rule Universally Unique Identifier Reference</formal-name>
                    <description>A rule UUID reference</description>
                </define-flag>
            </define-assembly>
        </model>
    </define-assembly>
</METASCHEMA>